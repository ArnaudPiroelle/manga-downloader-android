<?xml version="1.0" encoding="utf-8"?>
<MotionScene xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto">

    <Transition
        app:constraintSetEnd="@id/collapsed"
        app:constraintSetStart="@id/expanded">

        <OnSwipe
            app:dragDirection="dragUp"
            app:touchAnchorId="@id/chapters_list"
            app:touchAnchorSide="top" />

        <KeyFrameSet>
            <KeyPosition
                app:framePosition="20"
                app:keyPositionType="deltaRelative"
                app:percentY="0.51"
                app:target="@id/thumbnail_container" />

            <!-- This looks weird. We need a quick change from elevated to not-so-elevated at 20% so we set 2 key
                 attributes, one at 20% and other at 25%. -->
            <KeyAttribute
                android:elevation="4dp"
                android:rotation="45"
                android:rotationY="15"
                app:framePosition="20"
                app:target="@id/thumbnail_container" />

            <KeyAttribute
                android:elevation="0dp"
                app:framePosition="25"
                app:target="@id/thumbnail_container" />

        </KeyFrameSet>


        <ConstraintSet android:id="@+id/expanded">

            <Constraint
                android:id="@+id/appbar"
                android:layout_width="match_parent"
                android:layout_height="140dp"
                android:minHeight="?actionBarSize"
                app:layout_constraintEnd_toEndOf="parent"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toTopOf="parent" />

            <Constraint
                android:id="@id/thumbnail_container"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="24dp"
                android:layout_marginTop="8dp"
                android:alpha="1"
                android:scaleX="1.0"
                android:scaleY="1.0"
                app:layout_constraintBottom_toBottomOf="@+id/appbar"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/appbar" />

        </ConstraintSet>

        <ConstraintSet android:id="@+id/collapsed">

            <Constraint
                android:id="@+id/appbar"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:minHeight="?actionBarSize"
                app:layout_constraintEnd_toEndOf="parent"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toTopOf="parent" />

            <Constraint
                android:id="@id/thumbnail_container"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="24dp"
                android:layout_marginTop="8dp"
                android:alpha="0"
                android:scaleX="0.5"
                android:scaleY="0.5"
                app:layout_constraintBottom_toBottomOf="@+id/appbar"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/appbar" />
        </ConstraintSet>

    </Transition>


</MotionScene>